<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DualPay Calculator</title>

<link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@600&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>

<style>
body{font-family:'Montserrat',sans-serif;overflow:hidden;}

.bg-symbol{
position:absolute;
opacity:0.05;
font-size:42px;
color:#FFD700;
animation:float 14s infinite ease-in-out;
}

@keyframes float{
0%{transform:translate(0,0)}
50%{transform:translate(40px,-60px) rotate(12deg)}
100%{transform:translate(0,0)}
}
</style>
</head>

<body class="min-h-screen flex items-center justify-center bg-[#0a1a33]">

<div id="bg" class="absolute inset-0"></div>

<div class="relative w-full max-w-sm bg-[#0f2547]/70 backdrop-blur-xl rounded-3xl shadow-2xl p-6 text-white">

<!-- LOGO -->
<div class="flex justify-center mb-4">
<div class="bg-[#FFD700] text-[#0a1a33] rounded-xl px-4 py-2 font-[Comfortaa] shadow">
‚Ç¨ ‚áÑ –ª–≤
</div>
</div>

<h1 class="text-center text-xl font-[Comfortaa] mb-4 text-[#FFD700]">
DualPay Calculator
</h1>

<label class="text-sm">–°—É–º–∞ –∑–∞ –ø–ª–∞—â–∞–Ω–µ</label>
<div class="flex gap-2 mb-3">
<input id="price" type="number"
class="w-full p-2 rounded-lg bg-[#142d55]">
<select id="currency"
class="p-2 rounded-lg bg-[#142d55]">
<option>BGN</option>
<option>EUR</option>
</select>
</div>

<label class="text-sm">–ü–ª–∞—Ç–µ–Ω–æ –≤ –ª–≤</label>
<input id="paidBGN" type="number"
class="w-full p-2 rounded-lg mb-2 bg-[#142d55]">

<label class="text-sm">–ü–ª–∞—Ç–µ–Ω–æ –≤ ‚Ç¨</label>
<input id="paidEUR" type="number"
class="w-full p-2 rounded-lg mb-3 bg-[#142d55]">

<div id="error"
class="hidden bg-red-600 text-white p-2 rounded mb-2 text-center">
–ù–µ–¥–æ—Å—Ç–∞—Ç—ä—á–Ω–∞ —Å—É–º–∞
</div>

<!-- RESULT -->
<div id="resultBox" class="hidden text-center">

<p class="font-semibold mb-2">–†–µ—Å—Ç–æ</p>

<div class="flex justify-center gap-2 mb-2">
<button onclick="show('BGN')"
class="bg-[#FFD700] text-[#0a1a33] px-3 py-1 rounded">
BGN
</button>
<button onclick="show('EUR')"
class="bg-[#FFD700] text-[#0a1a33] px-3 py-1 rounded">
EUR
</button>
</div>

<p id="main" class="text-2xl font-bold text-[#FFD700]"></p>
<p id="secondary" class="text-sm opacity-70"></p>

<!-- SAVE -->
<button onclick="saveHistory()"
class="mt-3 bg-[#FFD700] text-[#0a1a33] px-4 py-2 rounded-lg font-bold shadow">
üíæ –ó–∞–ø–∞–∑–∏
</button>
</div>

<!-- HISTORY -->
<div class="mt-4">
<p class="text-sm font-semibold mb-1 text-[#FFD700]">–ò—Å—Ç–æ—Ä–∏—è</p>
<div id="history"
class="max-h-32 overflow-y-auto text-xs space-y-1"></div>
</div>

<p class="text-center text-xs mt-4 opacity-70">
–ö—É—Ä—Å: 1 EUR = 1.95583 BGN<br>
¬© –¢–µ–æ–¥–æ—Ä –î–∏–Ω–∫–æ–≤
</p>
</div>

<script>
const rate=1.95583;
let changeBGN=0;
let lastPaid=0;

[price,currency,paidBGN,paidEUR]
.forEach(i=>i.addEventListener("input",calc));

function calc(){
let sum=parseFloat(price.value)||0;
if(currency.value=="EUR") sum*=rate;

let paid=(parseFloat(paidBGN.value)||0)
+(parseFloat(paidEUR.value)||0)*rate;

if(paid<sum){
error.classList.remove("hidden");
resultBox.classList.add("hidden");
return;
}

error.classList.add("hidden");

changeBGN=paid-sum;
lastPaid=paid;
resultBox.classList.remove("hidden");
show("BGN");
}

function show(c){
if(c=="BGN"){
main.textContent=changeBGN.toFixed(2)+" –ª–≤";
secondary.textContent=
(changeBGN/rate).toFixed(2)+" ‚Ç¨";
}else{
main.textContent=
(changeBGN/rate).toFixed(2)+" ‚Ç¨";
secondary.textContent=
changeBGN.toFixed(2)+" –ª–≤";
}
}

function saveHistory(){
if(resultBox.classList.contains("hidden"))return;

const row=document.createElement("div");
row.className="bg-[#142d55] p-1 rounded";

row.innerHTML=
`–ü–ª–∞—Ç–µ–Ω–æ: ${lastPaid.toFixed(2)} –ª–≤ |
–†–µ—Å—Ç–æ: ${changeBGN.toFixed(2)} –ª–≤`;

history.prepend(row);
}
</script>

<!-- BACKGROUND -->
<script>
for(let i=0;i<30;i++){
let s=document.createElement("div");
s.className="bg-symbol";
s.textContent=i%2?"‚Ç¨":"–ª–≤";
s.style.left=Math.random()*100+"%";
s.style.top=Math.random()*100+"%";
s.style.animationDelay=
Math.random()*10+"s";
bg.appendChild(s);
}
</script>

<!-- ICON -->
<script>
const c=document.createElement("canvas");
c.width=512;c.height=512;
const x=c.getContext("2d");
x.fillStyle="#0a1a33";
x.fillRect(0,0,512,512);
x.fillStyle="#FFD700";
x.font="bold 90px Comfortaa";
x.textAlign="center";
x.fillText("‚Ç¨ ‚áÑ –ª–≤",256,300);

const link=document.createElement("link");
link.rel="icon";
link.href=c.toDataURL();
document.head.appendChild(link);
</script>

<!-- MANIFEST -->
<script>
const manifest={
name:"DualPay Calculator",
short_name:"DualPay",
start_url:".",
display:"standalone",
background_color:"#0a1a33",
theme_color:"#FFD700",
icons:[{
src:c.toDataURL(),
sizes:"512x512",
type:"image/png"
}]
};

const blob=new Blob(
[JSON.stringify(manifest)],
{type:"application/json"});

const mlink=document.createElement("link");
mlink.rel="manifest";
mlink.href=URL.createObjectURL(blob);
document.head.appendChild(mlink);
</script>

<!-- SERVICE WORKER -->
<script>
if("serviceWorker"in navigator){
const sw=`
self.addEventListener("install",e=>{
e.waitUntil(caches.open("v1")
.then(c=>c.addAll(["./"])))
});
self.addEventListener("fetch",e=>{
e.respondWith(
caches.match(e.request)
.then(r=>r||fetch(e.request))
)
});
`;
navigator.serviceWorker.register(
URL.createObjectURL(
new Blob([sw],
{type:"text/javascript"})
));
}
</script>

</body>
</html>
